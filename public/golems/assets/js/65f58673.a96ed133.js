"use strict";(globalThis.webpackChunk_golems_docsite=globalThis.webpackChunk_golems_docsite||[]).push([[5379],{6222(e,n,r){r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"golems/teller","title":"TellerGolem \u2014 Finance","description":"Subscription tracking, expense categorization (IRS Schedule C), payment failure detection, and financial reports.","source":"@site/docs/golems/teller.md","sourceDirName":"golems","slug":"/golems/teller","permalink":"/golems/docs/golems/teller","draft":false,"unlisted":false,"editUrl":"https://github.com/EtanHey/golems/tree/master/packages/docs/docs/golems/teller.md","tags":[],"version":"current","frontMatter":{"title":"TellerGolem \u2014 Finance","description":"Subscription tracking, expense categorization (IRS Schedule C), payment failure detection, and financial reports."},"sidebar":"mainSidebar","previous":{"title":"RecruiterGolem \u2014 Outreach & Practice","permalink":"/golems/docs/golems/recruiter"},"next":{"title":"Environment Variables","permalink":"/golems/docs/configuration/env-vars"}}');var i=r(4848),s=r(8453);const l={title:"TellerGolem \u2014 Finance",description:"Subscription tracking, expense categorization (IRS Schedule C), payment failure detection, and financial reports."},a="TellerGolem",o={},c=[{value:"Pipeline",id:"pipeline",level:2},{value:"Core Features",id:"core-features",level:2},{value:"Payment Failure Detection",id:"payment-failure-detection",level:3},{value:"Expense Categorization",id:"expense-categorization",level:3},{value:"Monthly Reports",id:"monthly-reports",level:3},{value:"Tax Reports",id:"tax-reports",level:3},{value:"Files",id:"files",level:2},{value:"MCP Tools",id:"mcp-tools",level:2},{value:"Running TellerGolem",id:"running-tellergolem",level:2},{value:"Integration Points",id:"integration-points",level:2},{value:"Environment Variables",id:"environment-variables",level:2},{value:"Roadmap",id:"roadmap",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"tellergolem",children:"TellerGolem"})}),"\n",(0,i.jsx)(n.p,{children:"TellerGolem is the finance domain expert. It processes subscription emails routed from EmailGolem, categorizes expenses for IRS Schedule C tax purposes, detects payment failures, and generates financial reports (monthly and annual)."}),"\n",(0,i.jsx)(n.h2,{id:"pipeline",children:"Pipeline"}),"\n",(0,i.jsx)(n.mermaid,{value:"flowchart TD\n    A[EmailGolem<br/>subscription emails] --\x3e B[TellerGolem.processSubscriptionEmail]\n    B --\x3e C[Payment failure detection]\n    B --\x3e D[Expense categorization]\n    B --\x3e E[Payment recording]\n    B --\x3e F[Subscription tracking]\n    B --\x3e G[Event logging]\n    C --\x3e H[Telegram alert]\n    D --\x3e I[IRS Schedule C]\n    E --\x3e J[(Supabase)]\n    F --\x3e J\n    G --\x3e K[event-log.json]"}),"\n",(0,i.jsx)(n.h2,{id:"core-features",children:"Core Features"}),"\n",(0,i.jsx)(n.h3,{id:"payment-failure-detection",children:"Payment Failure Detection"}),"\n",(0,i.jsx)(n.p,{children:"Regex pre-check + LLM confirmation for failed charges:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// alerts.ts\nconst FAILURE_PATTERNS = [\n  /payment\\s+(failed|declined|unsuccessful)/i,\n  /card\\s+(declined|expired|rejected)/i,\n  /billing\\s+(issue|problem|error)/i,\n  /unable\\s+to\\s+(charge|process|complete)/i,\n  /action\\s+required.*payment/i,\n  /update.*payment\\s+method/i,\n];\n"})}),"\n",(0,i.jsxs)(n.p,{children:["When a failure is detected, TellerGolem sends a Telegram alert and logs an ",(0,i.jsx)(n.code,{children:"email_alert"})," event."]}),"\n",(0,i.jsx)(n.h3,{id:"expense-categorization",children:"Expense Categorization"}),"\n",(0,i.jsxs)(n.p,{children:["Uses LLM (via ",(0,i.jsx)(n.code,{children:"runOllamaJSON"}),") to categorize emails into IRS Schedule C categories:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'// categorizer.ts \u2014 Valid categories\ntype TaxCategory =\n  | "advertising" | "insurance" | "office" | "software"\n  | "education" | "travel" | "meals"\n  | "professional-services" | "other";\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Returns a ",(0,i.jsx)(n.code,{children:"CategorizedExpense"})," with category, confidence (0-1), reasoning, extracted amount, and vendor name."]}),"\n",(0,i.jsx)(n.h3,{id:"monthly-reports",children:"Monthly Reports"}),"\n",(0,i.jsxs)(n.p,{children:["Queries the ",(0,i.jsx)(n.code,{children:"payments"})," table in Supabase and aggregates by category and vendor:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// report.ts\ninterface MonthlyReport {\n  month: string;        // YYYY-MM\n  totalSpend: number;\n  byCategory: Record<TaxCategory, number>;\n  byVendor: Record<string, number>;\n  subscriptionCount: number;\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"tax-reports",children:"Tax Reports"}),"\n",(0,i.jsx)(n.p,{children:"Annual report with deductible totals and line items per category:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"interface TaxReport {\n  year: number;\n  totalDeductible: number;\n  byCategory: Record<TaxCategory, {\n    total: number;\n    items: Array<{ vendor: string; amount: number }>;\n  }>;\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"files",children:"Files"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"src/teller-golem/\n\u251c\u2500\u2500 index.ts          \u2014 Main orchestrator, processSubscriptionEmail(), CLI\n\u251c\u2500\u2500 categorizer.ts    \u2014 LLM expense categorization into IRS Schedule C\n\u251c\u2500\u2500 alerts.ts         \u2014 Payment failure detection + Telegram alerts\n\u251c\u2500\u2500 report.ts         \u2014 Monthly and annual report generation\n\u2514\u2500\u2500 types.ts          \u2014 TypeScript interfaces (TaxCategory, MonthlyReport, etc.)\n"})}),"\n",(0,i.jsx)(n.h2,{id:"mcp-tools",children:"MCP Tools"}),"\n",(0,i.jsxs)(n.p,{children:["TellerGolem exposes two MCP tools via the ",(0,i.jsx)(n.code,{children:"golems-email"})," MCP server (in ",(0,i.jsx)(n.code,{children:"email-golem/mcp-server.ts"}),"):"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"teller_monthlyReport"})})," \u2014 Generate monthly spending report (by category and vendor)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:"teller_taxSummary"})})," \u2014 Generate annual tax report with IRS Schedule C breakdown"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"running-tellergolem",children:"Running TellerGolem"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"cd packages/teller\n\n# Monthly report (current month)\nbun run src/index.ts --report\n\n# Specific month\nbun run src/index.ts --report --month 2026-02\n\n# Tax report (current year)\nbun run src/index.ts --report --tax\n\n# Specific tax year\nbun run src/index.ts --report --tax --year 2025\n"})}),"\n",(0,i.jsx)(n.h2,{id:"integration-points",children:"Integration Points"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"EmailGolem"})," \u2014 Routes subscription emails via ",(0,i.jsx)(n.code,{children:"router.ts"})," (category ",(0,i.jsx)(n.code,{children:"subscription"})," -> ",(0,i.jsx)(n.code,{children:"tellergolem"}),")"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Event Logger"})," \u2014 Logs ",(0,i.jsx)(n.code,{children:"email_routed"})," and ",(0,i.jsx)(n.code,{children:"email_alert"})," events"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Telegram"})," \u2014 Payment failure alerts sent via ",(0,i.jsx)(n.code,{children:"telegram-direct.ts"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Supabase"})," \u2014 Payments and subscriptions stored via ",(0,i.jsx)(n.code,{children:"db-client.ts"})]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# LLM for categorization\nexport LLM_BACKEND=haiku  # or 'ollama' for local\n\n# Database\nexport SUPABASE_URL=...\nexport SUPABASE_SERVICE_KEY=...\n"})}),"\n",(0,i.jsx)(n.h2,{id:"roadmap",children:"Roadmap"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Phase"}),(0,i.jsx)(n.th,{children:"Status"}),(0,i.jsx)(n.th,{children:"Scope"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Phase 1"}),(0,i.jsx)(n.td,{children:"Done"}),(0,i.jsx)(n.td,{children:"Email routing to TellerGolem"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Phase 2"}),(0,i.jsx)(n.td,{children:"Done"}),(0,i.jsx)(n.td,{children:"Cloud offload, Supabase schema, state persistence"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Phase 3"}),(0,i.jsx)(n.td,{children:"Done"}),(0,i.jsx)(n.td,{children:"Categorizer, alerts, reports, types, MCP tools"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Future"}),(0,i.jsx)(n.td,{children:"Planned"}),(0,i.jsx)(n.td,{children:"Budget forecasting, unused subscription detection, accounting integrations"})]})]})]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,n,r){r.d(n,{R:()=>l,x:()=>a});var t=r(6540);const i={},s=t.createContext(i);function l(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);